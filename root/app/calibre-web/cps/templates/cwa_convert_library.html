{% extends "layout.html" %}

{% block body %}
<div class="discover">
  <h2>{{title}}</h2>
    <div>
      <h3>CWA Library Convertor</h3><br>
      <div class="row">
        <div class="logging_window">
          <h2 id="innerStatus">Loading...</h2>
        </div>
      </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
  var timeout;
  
  async function getStatus() {
  
    let get;
    
    try {
      const res = await fetch("/convert-library-status");
      get = await res.json();
    } catch (e) {
      console.error("Error: ", e);
    }
    
    document.getElementById("innerStatus").innerHTML = get.status.replace(/\n/g, "<br>"); // * 10 + "&percnt;"
    
    if (get.status == "Done!"){
      document.getElementById("innerStatus").innerHTML;
      clearTimeout(timeout);
      return false;
    }
  
    timeout = setTimeout(getStatus, 1000);
  }
  
  getStatus();
  </script>
{% endblock %}
